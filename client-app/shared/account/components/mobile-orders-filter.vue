<template>
  <!-- Mobile filters -->
  <div v-if="isMobile" class="flex flex-col gap-4 lg:gap-5">
    <VcWidget v-if="!!facets" :title="$t('shared.account.orders-filter.status-label')" size="sm" collapsible>
      <div class="flex flex-col space-y-4">
        <VcCheckbox
          v-for="facet in facets"
          :key="facet.term"
          v-model="filterData.statuses"
          :value="facet.term"
          :class="[{ 'font-bold': isSelectedStatus(facet.term), 'text-gray-500': !isSelectedStatus(facet.term) }]"
        >
          <div class="flex gap-1">
            <div class="min-w-0 grow truncate">{{ facet.label }}</div>
            <VcBadge variant="outline" rounded>{{ facet.count }}</VcBadge>
          </div>
        </VcCheckbox>
      </div>
    </VcWidget>

    <VcWidget :title="$t('shared.account.orders-filter.created-date-label')" size="sm">
      <div class="flex flex-col space-y-3">
        <div>
          <VcDateSelector v-model="filterData.startDate" :label="$t('shared.account.orders-filter.start-date-label')" />
        </div>
        <div>
          <VcDateSelector v-model="filterData.endDate" :label="$t('shared.account.orders-filter.end-date-label')" />
        </div>
      </div>
    </VcWidget>
  </div>
</template>

<script setup lang="ts">
import { breakpointsTailwind, useBreakpoints } from "@vueuse/core";
import { useUserOrders, useUserOrdersFilter } from "../composables";

const { facets } = useUserOrders({});
const { filterData } = useUserOrdersFilter();

const breakpoints = useBreakpoints(breakpointsTailwind);
const isMobile = breakpoints.smaller("lg");

function isSelectedStatus(status: string) {
  return filterData.value.statuses.indexOf(status) !== -1;
}
</script>
