{%- layout 'designer-preview' -%}

<style>
  html, body, .preview-frame {
      border: none;
      height: 100%;
      width: 100%;
      /* display: none; */
      z-index: 0;
      margin: 0;
      padding: 0;
  }
</style>
<iframe class="preview-frame" style="display: block; background: white;" id="preview-a" src="" title="" data-view-mode="page-builder"></iframe>

<script>
    (function() {
        var platformUrl = window.location.search.substr(1).split('&').find(q => q.startsWith('ep=')).substr(3);

        var storeUrl = window.location.origin;
        var frame = document.getElementById('preview-a');
        frame.src = storeUrl;
        var relativeUrl = (platformUrl.endsWith('/') ? '' : '/') + 'Modules/$(VirtoCommerce.PageBuilderModule)/Content/bridge/bridge.bundle.js';
        var script = document.createElement("script");
        script.type = "text/javascript";
        script.src = platformUrl + relativeUrl;
        script.onload = function() {
          window['designerPreviewApp'](frame, platformUrl);
        };
        document.body.appendChild(script);
    })();
</script>
